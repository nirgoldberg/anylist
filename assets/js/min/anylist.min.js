/*! anylist 2018-10-28 */

function anylist_filter_content_toggle(_){var t=_.currentTarget;!!$(t).hasClass("collapsed")?$(t).removeClass("collapsed"):$(t).addClass("collapsed")}function anylist_subcategories_menu_toggle(_){var t=_.currentTarget,i=$(t).parent();!!i.hasClass("collapsed")?i.removeClass("collapsed").find("li.has-children").removeClass("collapsed"):i.addClass("collapsed")}function anylist_map_categories_menu(_){var t=_.currentTarget,i=$(t).attr("id").substring(12),e=-1!=i.indexOf("all"),r=e?i.substring(0,i.length-4):i,n=$(t).is(":checked"),c=!1,s=anylist_categories_menu_get_item_parent(r);(n?(anylist_categories_menu_uncheck_parents(r,s),e&&anylist_categories_menu_uncheck_children(r),!1!==s&&(c=_ANYLIST_products_filter_categories[s][r][1]=!0)):anylist_categories_menu_is_single_checked_item(r)?$(t).prop("checked",!0):!1!==s&&(c=!(_ANYLIST_products_filter_categories[s][r][1]=!1)),c)&&anylist_filter_products_ajax(anylist_get_checked_categories())}function anylist_categories_menu_get_item_parent(e){var r=!1;return $.each(_ANYLIST_products_filter_categories,function(i,_){if($.each(_,function(_,t){if(_==e)return r=i,!1}),r)return!1}),r}function anylist_categories_menu_uncheck_parents(_,t){t||(t=anylist_categories_menu_get_item_parent(_)),!1!==t&&(anylist_categories_menu_uncheck_item(t),anylist_categories_menu_uncheck_parents(t))}function anylist_categories_menu_uncheck_children(t){$.each(_ANYLIST_products_filter_categories,function(i,_){i==t&&$.each(_,function(_,t){anylist_categories_menu_uncheck_item(_,i),anylist_categories_menu_uncheck_children(_)})})}function anylist_categories_menu_uncheck_item(_,t){t||(t=anylist_categories_menu_get_item_parent(_)),!1!==t&&(_ANYLIST_products_filter_categories[t][_][1]=!1),anylist_categories_menu_uncheck_input(_)}function anylist_categories_menu_uncheck_input(_){var t=$(".anylist-category-filter .categories").find("li.cat-"+_);t.length&&(t.hasClass("has-children")?input=t.find("li.cat-"+_+"-all").children("input"):input=t.children("input"),input.length&&input.prop("checked",!1))}function anylist_categories_menu_is_single_checked_item(i){return result=!0,$.each(_ANYLIST_products_filter_categories,function(_,t){if($.each(t,function(_,t){if(t[1]&&_!=i)return result=!1}),!result)return!1}),result}function anylist_get_checked_categories(){var i=[];return $.each(_ANYLIST_products_filter_categories,function(_,t){$.each(t,function(_,t){t[1]&&i.push(_)})}),i}function anylist_filter_products_ajax(_){if(null!=_){var t=$(".anylist-widget .anylist-loader");t.show(),$.ajax({url:_ANYLIST_products_filter_ajaxurl,type:"POST",data:{action:"filter_products",taxonomy:"product_cat",term_ids:_,wpml_lang:_ANYLIST_products_filter_wpml_lang,tax_list:_ANYLIST_products_filter_tax_list},success:function(_){return _=JSON.parse(_),_ANYLIST_products_filter_min_price=_.min_price,_ANYLIST_products_filter_max_price=_.max_price,_ANYLIST_products_filter_min_handle_price=_.min_handle_price,_ANYLIST_products_filter_max_handle_price=_.max_handle_price,_ANYLIST_products_filter_taxonomies=_.taxonomies,_ANYLIST_products_filter_products=_.products,anylist_display_products_filter(!0),anylist_update_products_grid_ajax(_.products_grid),t.hide(),!0},error:function(_){return t.hide(),!1}})}}function anylist_init_price_slider(_,t,i,e){$("#anylist-price-filter-slider").slider({animate:!0,range:!0,min:_,max:t,values:[i,e],slide:function(_,t){$("#anylist-price-filter-amount").val(_ANYLIST_products_filter_currency+t.values[0]+" - "+_ANYLIST_products_filter_currency+t.values[1])},change:function(_,t){anylist_price_slider_change(t.values[0],t.values[1])}}),$("#anylist-price-filter-amount").val(_ANYLIST_products_filter_currency+$("#anylist-price-filter-slider").slider("values",0)+" - "+_ANYLIST_products_filter_currency+$("#anylist-price-filter-slider").slider("values",1))}function anylist_price_slider_change(_,t){_ANYLIST_products_filter_min_handle_price=_,_ANYLIST_products_filter_max_handle_price=t,anylist_filter_products()}function anylist_map_taxonomy_terms(){$(".anylist-tax-filter").each(function(){var _=$(this).attr("class").split(/\s+/),t=$(this).find(".tax-terms");tax_name="",$.each(_,function(_,t){0<=t.indexOf("anylist-tax-filter-")&&(tax_name=t.substring(16))}),t.find("input").each(function(){var _=$(this).attr("id");_ANYLIST_products_filter_taxonomies[tax_name][2][_][1]=$(this).is(":checked")?1:0})}),anylist_filter_products()}function anylist_filter_products(){return anylist_update_products_filter(),anylist_update_products_grid(),!0}function anylist_update_products_filter(){_ANYLIST_products_filter_min_price=null,_ANYLIST_products_filter_max_price=null,$.each(_ANYLIST_products_filter_taxonomies,function(_,t){t[1]=0,$.each(t[2],function(_,t){t[0]=0})}),$.each(_ANYLIST_products_filter_products,function(_,e){if(e[1]=1,$.each(_ANYLIST_products_filter_taxonomies,function(i,_){if($.each(_[2],function(_,t){if(t[1]&&-1==$.inArray(parseInt(_),e[2][i]))return e[1]=0,!1}),!e[1])return!1}),!e[1])return!0;var t=e[0];if(_ANYLIST_products_filter_min_price&&_ANYLIST_products_filter_max_price?(_ANYLIST_products_filter_min_price=t<_ANYLIST_products_filter_min_price?t:_ANYLIST_products_filter_min_price,_ANYLIST_products_filter_max_price=t>_ANYLIST_products_filter_max_price?t:_ANYLIST_products_filter_max_price):_ANYLIST_products_filter_min_price=_ANYLIST_products_filter_max_price=t,t<_ANYLIST_products_filter_min_handle_price||t>_ANYLIST_products_filter_max_handle_price)return!(e[1]=0);$.each(e[2],function(i,_){0<_.length&&(_ANYLIST_products_filter_taxonomies[i][1]++,$.each(_,function(_,t){_ANYLIST_products_filter_taxonomies[i][2][t][0]++}))})}),anylist_display_products_filter()}function anylist_display_products_filter(e){_ANYLIST_products_filter_show_price_filter&&(min_handle_price=_ANYLIST_products_filter_min_price&&_ANYLIST_products_filter_min_handle_price<_ANYLIST_products_filter_min_price?_ANYLIST_products_filter_min_price:_ANYLIST_products_filter_min_handle_price,max_handle_price=_ANYLIST_products_filter_max_price&&_ANYLIST_products_filter_max_handle_price>_ANYLIST_products_filter_max_price?_ANYLIST_products_filter_max_price:_ANYLIST_products_filter_max_handle_price,(_ANYLIST_products_filter_price_filter_init||_ANYLIST_products_filter_min_price!=_ANYLIST_products_filter_max_price)&&(_ANYLIST_products_filter_price_filter_init?$("#anylist-price-filter-slider").slider("destroy"):($(".anylist-price-filter").show(),_ANYLIST_products_filter_price_filter_init=!0),anylist_init_price_slider(_ANYLIST_products_filter_min_price,_ANYLIST_products_filter_max_price,min_handle_price,max_handle_price))),$.each(_ANYLIST_products_filter_taxonomies,function(_,t){0==t[1]?$(".anylist-tax-filter-"+_).hide():($(".anylist-tax-filter-"+_).show(),$.each(t[2],function(_,t){if(0==t[0])$(".anylist-tax-filter input#"+_).parent("li").hide();else{var i=$(".anylist-tax-filter input#"+_);i.parent("li").find("span.count").html(t[0]),e&&i.prop("checked",!1),i.parent("li").show()}}))})}function anylist_update_products_grid(){var e=0;$(".anylist-not-found").hide(),$("ul.products li").hide(),$("ul.products li").each(function(_){var t=$(this).attr("class").match(/post-(\d+)/g),i=parseInt(t[0].substring(5));_ANYLIST_products_filter_products[i][1]&&($(this).show(),e++)}),e||$(".anylist-not-found").show()}function anylist_update_products_grid_ajax(_){$("ul.products").html(_),$("ul.products > li").addClass("product")}jQuery(function(_){_(".anylist-filter-title").bind("click",anylist_filter_content_toggle),_(".anylist-filter").first().children(".anylist-filter-title").addClass("collapsed");var t='<div class="anylist-not-found" style="display: none;">'+_ANYLIST_products_filter_not_found+"</div>";_("ul.products").after(t),_ANYLIST_products_filter_show_categories_menu&&(_(".anylist-category-filter li.has-children > .item-before").bind("click",anylist_subcategories_menu_toggle),_(".anylist-category-filter li.has-children > a").bind("click",anylist_subcategories_menu_toggle),_(".anylist-category-filter input").bind("change",anylist_map_categories_menu)),_ANYLIST_products_filter_show_price_filter&&(_ANYLIST_products_filter_price_filter_init=!1,_ANYLIST_products_filter_min_price!=_ANYLIST_products_filter_max_price?(anylist_init_price_slider(_ANYLIST_products_filter_min_price,_ANYLIST_products_filter_max_price,_ANYLIST_products_filter_min_handle_price,_ANYLIST_products_filter_max_handle_price),_ANYLIST_products_filter_price_filter_init=!0):_(".anylist-price-filter").hide()),_(".anylist-tax-filter .tax-terms input").bind("change",anylist_map_taxonomy_terms)});